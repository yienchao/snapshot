<Window x:Class="ViewTracker.Views.RoomRestoreWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Restore Rooms from Snapshot"
        Height="750" Width="900"
        WindowStartupLocation="CenterScreen"
        Background="#F5F5F5">

    <Window.Resources>
        <Style TargetType="Button">
            <Setter Property="Padding" Value="15,8"/>
            <Setter Property="Margin" Value="5"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <Style TargetType="CheckBox">
            <Setter Property="Margin" Value="5,3"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>
    </Window.Resources>

    <Grid Margin="15">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#2196F3" Padding="15" CornerRadius="5" Margin="0,0,0,15">
            <StackPanel>
                <TextBlock Text="Restore Rooms from Snapshot" FontSize="20" FontWeight="Bold" Foreground="White"/>
                <TextBlock Text="Select a version and parameters to restore" FontSize="12" Foreground="White" Margin="0,5,0,0"/>
            </StackPanel>
        </Border>

        <!-- Main Content: Two Columns -->
        <Grid Grid.Row="1">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="400"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- LEFT COLUMN: Options -->
            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto" Margin="0,0,10,0">
                <StackPanel>
                    <!-- Version Selection -->
                    <GroupBox Header="Select Version" Padding="10" Margin="0,0,0,10">
                        <StackPanel>
                            <ComboBox x:Name="VersionComboBox"
                                      DisplayMemberPath="DisplayName"
                                      SelectionChanged="VersionComboBox_SelectionChanged"
                                      Padding="8" FontSize="13"/>
                            <TextBlock x:Name="VersionInfoText"
                                       Margin="5,8,0,0"
                                       FontSize="11"
                                       Foreground="#666"
                                       TextWrapping="Wrap"/>
                        </StackPanel>
                    </GroupBox>

                    <!-- Scope -->
                    <GroupBox Header="Scope" Padding="10" Margin="0,0,0,10">
                        <StackPanel>
                            <RadioButton x:Name="AllRoomsRadio" Content="All rooms with trackID" IsChecked="True"
                                         GroupName="Scope" Checked="ScopeRadio_Changed"/>
                            <RadioButton x:Name="SelectedRoomsRadio" Content="Pre-selected rooms only"
                                         GroupName="Scope" Margin="0,5,0,0" Checked="ScopeRadio_Changed"/>
                            <RadioButton x:Name="DeletedRoomsRadio" Content="Deleted rooms only (recreate)"
                                         GroupName="Scope" Margin="0,5,0,0" Checked="ScopeRadio_Changed"/>
                            <TextBlock x:Name="ScopeInfoText" Margin="20,5,0,0" FontSize="11" Foreground="#666"/>
                        </StackPanel>
                    </GroupBox>

                    <!-- Status Info -->
                    <Border Background="White" BorderBrush="#DDD" BorderThickness="1"
                            Padding="10" CornerRadius="3" Margin="0,0,0,10">
                        <ScrollViewer MaxHeight="120" VerticalScrollBarVisibility="Auto">
                            <StackPanel x:Name="StatusPanel">
                                <TextBlock Text="Status:" FontWeight="Bold" Margin="0,0,0,5"/>
                                <TextBlock x:Name="StatusText" TextWrapping="Wrap" FontSize="12"/>
                            </StackPanel>
                        </ScrollViewer>
                    </Border>

                    <!-- Safety Options -->
                    <GroupBox Header="Options" Padding="10" Margin="0,0,0,10">
                        <StackPanel>
                            <CheckBox x:Name="ChkCreateBackup" Content="Create backup snapshot before restoring"
                                      IsChecked="True" FontWeight="Bold"/>
                            <CheckBox x:Name="ChkRecreateDeleted" Content="Recreate deleted rooms (unplaced in schedule)"
                                      IsChecked="False" Margin="0,8,0,0"
                                      Checked="RecreateDeleted_Changed" Unchecked="RecreateDeleted_Changed"/>
                            <CheckBox x:Name="ChkRestorePlacement" Content="↳ Place at original location (position, level, phase)"
                                      IsChecked="False" Margin="20,4,0,0" FontSize="12"
                                      IsEnabled="False"
                                      ToolTip="Places recreated rooms at their original position, level, and phase from snapshot"/>
                        </StackPanel>
                    </GroupBox>
                </StackPanel>
            </ScrollViewer>

            <!-- RIGHT COLUMN: Parameters -->
            <GroupBox Grid.Column="1" Header="Select Parameters to Restore" Padding="10">
                <StackPanel>
                    <StackPanel Orientation="Horizontal" Margin="0,0,0,8">
                        <Button Content="Select All" Click="SelectAll_Click" Padding="10,5" FontSize="12"/>
                        <Button Content="Select None" Click="SelectNone_Click" Padding="10,5" FontSize="12"/>
                    </StackPanel>

                    <!-- Scrollable parameter list -->
                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel x:Name="ParameterCheckboxPanel">
                            <!-- Dynamically populated with checkboxes -->
                        </StackPanel>
                    </ScrollViewer>

                    <TextBlock Text="ℹ️ Read-only parameters (Area, Perimeter, Volume) are automatically skipped"
                               Margin="0,10,0,0" FontSize="11" Foreground="#FF9800" TextWrapping="Wrap"/>
                </StackPanel>
            </GroupBox>
        </Grid>

        <!-- Action Buttons -->
        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,10,0,0">
            <Button Content="Preview Changes..." Click="Preview_Click" Background="#2196F3" Foreground="White"/>
            <Button Content="Cancel" Click="Cancel_Click" Background="#757575" Foreground="White"/>
            <Button Content="Restore" Click="Restore_Click" Background="#4CAF50" Foreground="White" FontWeight="Bold"/>
        </StackPanel>
    </Grid>
</Window>
